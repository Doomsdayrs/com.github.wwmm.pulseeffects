{
  "app-id": "com.github.wwmm.pulseeffects",
  "runtime": "org.gnome.Platform",
  "runtime-version": "3.26",
  "sdk": "org.gnome.Sdk",
  "sdk-extensions": ["org.freedesktop.Sdk.Extension.gfortran-62"],
  "command": "pulseeffects",
  "rename-icon": "pulseeffects",
  "finish-args": [
    /* Wayland access */
    "--socket=wayland",
    /* Sound access */
    "--socket=pulseaudio",
    /* X11 + XShm access */
    "--share=ipc", "--socket=x11",
    /* Dconf access*/
    "--env=DCONF_USER_CONFIG_DIR=.config/dconf",
    "--filesystem=xdg-run/dconf",
    "--filesystem=~/.config/dconf:ro",
    "--talk-name=ca.desrt.dconf"
  ],
  "cleanup": [
    "*.a",
    "*.h",
    "*.la",
    "/include",
    "/lib/pkgconfig"
  ],
  "modules": [
    {
      "name": "pulseeffects",
      "buildsystem": "meson",
      "builddir": true,
      "sources": [{
        "type": "git",
        "url": "https://github.com/wwmm/pulseeffects.git",
        "branch": "v3.0.4",
        "commit": "f5c7af7095109c26064ff2f7bf79d9909b8e2884"
      }],
      "post-install": [
        "install -Dm644 ../LICENSE.md /app/share/licenses/com.github.wwmm.pulseeffects/LICENSE"
      ],
      "modules": [
        {
          "name": "gfortran",
          "buildsystem": "simple",
          "build-commands": [ "/usr/lib/sdk/gfortran-62/install.sh" ]
        },
        {
          "name": "lapack",
          "buildsystem": "cmake",
          "builddir": true,
          "config-opts": [
            "-DCMAKE_INSTALL_PREFIX=/app",
            "-DCMAKE_INSTALL_LIBDIR=lib",
            "-DCMAKE_BUILD_TYPE=Release",
            "-DBUILD_SHARED_LIBS=ON",
            "-DBUILD_TESTING=OFF",
            "-DCMAKE_Fortran_COMPILER=/usr/lib/sdk/gfortran-62/bin/gfortran",
            "-DLAPACKE=ON",
            "-DCBLAS=ON"
          ],
          "sources": [{
            "type": "archive",
            "url": "http://www.netlib.org/lapack/lapack-3.7.1.tgz",
            "sha256": "f6c53fd9f56932f3ddb3d5e24c1c07e4cd9b3b08e7f89de9c867125eecc9a1c8"
          }],
          "post-install": [
            "install -Dm644 ../LICENSE /app/share/licenses/lapack/LICENSE"
          ],
          "cleanup": [ "/lib/cmake" ]
        },
        {
          "name": "numpy",
          "buildsystem": "simple",
          "build-commands": [
            "PATH=$PATH:/usr/lib/sdk/gfortran-62/bin python3 setup.py build -j 0",
            "python3 setup.py install --prefix=/app --root=/ --optimize=1"
          ],
          "build-options": {
            "env": { "ATLAS": "None", "BLAS": "/app/lib", "LAPACK": "/app/lib" }
          },
          "sources": [{
            "type": "archive",
            "url": "https://github.com/numpy/numpy/releases/download/v1.13.3/numpy-1.13.3.tar.gz",
            "sha256": "4c6b4eef790528bebb7ec9590d74cc193868940fe68e4109a91c196df72d8094"
          }],
          "post-install": [
            "install -Dm644 LICENSE.txt /app/share/licenses/numpy/LICENSE"
          ],
          "cleanup": [ "*.h", "/bin", "libnpymath.a", "*/core/include" ]
        },
        {
          "name": "scipy",
          "buildsystem": "simple",
          "build-commands": [
            "PATH=$PATH:/usr/lib/sdk/gfortran-62/bin python3 setup.py build",
            "python3 setup.py install --prefix=/app --root=/ --optimize=1"
          ],
          "build-options": {
            "ldflags": "-shared",
            "env": { "ATLAS": "None", "BLAS": "/app/lib", "LAPACK": "/app/lib" }
          },
          "sources": [{
            "type": "archive",
            "url": "https://github.com/scipy/scipy/releases/download/v0.19.1/scipy-0.19.1.tar.xz",
            "sha256": "0dca04c4860afdcb066cab4fd520fcffa8c85e9a7b5aa37a445308e899d728b3"
          }],
          "post-install": [
            "install -Dm644 LICENSE.txt /app/share/licenses/scipy/LICENSE"
          ]
        },
        {
          "name": "gst-plugins-bad",
          "config-opts": [
            "--disable-accurip",
            "--disable-adpcmdec",
            "--disable-adpcmenc",
            "--disable-aiff",
            "--disable-videoframe_audiolevel",
            "--disable-asfmux",
            "--disable-audiobuffersplit",
            "--disable-audiofxbad",
            "--disable-audiomixer",
            "--disable-audiomixmatrix",
            "--disable-compositor",
            "--disable-audiovisualizers",
            "--disable-autoconvert",
            "--disable-bayer",
            "--disable-camerabin2",
            "--disable-coloreffects",
            "--disable-debugutils",
            "--disable-dvbsuboverlay",
            "--disable-dvdspu",
            "--disable-faceoverlay",
            "--disable-festival",
            "--disable-fieldanalysis",
            "--disable-freeverb",
            "--disable-frei0r",
            "--disable-gaudieffects",
            "--disable-geometrictransform",
            "--disable-gdp",
            "--disable-id3tag",
            "--disable-inter",
            "--disable-interlace",
            "--disable-ivfparse",
            "--disable-ivtc",
            "--disable-jp2kdecimator",
            "--disable-jpegformat",
            "--disable-librfb",
            "--disable-midi",
            "--disable-mpegdemux",
            "--disable-mpegtsdemux",
            "--disable-mpegtsmux",
            "--disable-mpegpsmux",
            "--disable-mxf",
            "--disable-netsim",
            "--disable-onvif",
            "--disable-pcapparse",
            "--disable-pnm",
            "--disable-rawparse",
            "--disable-removesilence",
            "--disable-sdp",
            "--disable-segmentclip",
            "--disable-siren",
            "--disable-smooth",
            "--disable-speed",
            "--disable-subenc",
            "--disable-stereo",
            "--disable-timecode",
            "--disable-videofilters",
            "--disable-videoparsers",
            "--disable-videosignal",
            "--disable-vmnc",
            "--disable-y4m",
            "--disable-yadif",
            "--disable-directsound",
            "--disable-wasapi",
            "--disable-direct3d",
            "--disable-winscreencap",
            "--disable-winks",
            "--disable-android_media",
            "--disable-apple_media",
            "--disable-bluez",
            "--disable-avc",
            "--disable-shm",
            "--disable-vcd",
            "--disable-opensles",
            "--disable-uvch264",
            "--disable-nvenc",
            "--disable-tinyalsa",
            "--disable-msdk",
            "--disable-assrender",
            "--disable-voamrwbenc",
            "--disable-voaacenc",
            "--disable-bs2b",
            "--disable-bz2",
            "--disable-chromaprint",
            "--disable-curl",
            "--disable-dash",
            "--disable-dc1394",
            "--disable-decklink",
            "--disable-directfb",
            "--disable-wayland",
            "--disable-webp",
            "--disable-daala",
            "--disable-dts",
            "--disable-resindvd",
            "--disable-faac",
            "--disable-faad",
            "--disable-fbdev",
            "--disable-fdk_aac",
            "--disable-flite",
            "--disable-gsm",
            "--disable-fluidsynth",
            "--disable-kate",
            "--disable-kms",
            "--disable-lv2",
            "--disable-libde265",
            "--disable-libmms",
            "--disable-srtp",
            "--disable-dtls",
            "--disable-ttml",
            "--disable-modplug",
            "--disable-mpeg2enc",
            "--disable-mplex",
            "--disable-musepack",
            "--disable-neon",
            "--disable-ofa",
            "--disable-openal",
            "--disable-opencv",
            "--disable-openexr",
            "--disable-openh264",
            "--disable-openjpeg",
            "--disable-openni2",
            "--disable-opus",
            "--disable-rsvg",
            "--disable-gl",
            "--disable-gtk3",
            "--disable-qt",
            "--disable-vulkan",
            "--disable-teletextdec",
            "--disable-wildmidi",
            "--disable-smoothstreaming",
            "--disable-sndfile",
            "--disable-soundtouch",
            "--disable-spc",
            "--disable-gme",
            "--disable-dvb",
            "--disable-acm",
            "--disable-vdpau",
            "--disable-sbc",
            "--disable-schro",
            "--disable-zbar",
            "--disable-rtmp",
            "--disable-spandsp",
            "--disable-hls",
            "--disable-x265",
            "--disable-webrtcdsp"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://gstreamer.freedesktop.org/src/gst-plugins-bad/gst-plugins-bad-1.12.3.tar.xz",
              "sha256": "36d059761852bed0f1a7fcd3ef64a8aeecab95d2bca53cd6aa0f08054b1cbfec"
            }
          ],
          "post-install": [
            "install -Dm644 COPYING /app/share/licenses/gst-plugins-bad/COPYING",
            "install -m644 COPYING.LIB /app/share/licenses/gst-plugins-bad"
          ],
          "cleanup": [
            "/lib/girepository-1.0",
            "/lib/gstreamer-1.0/include",
            "/share/gir-1.0",
            "/share/gtk-doc"
          ],
          "modules": [
            {
              "name": "ladspa-sdk",
              "make-args": [ "targets" ],
              "make-install-args": [
                "INSTALL_BINARY_DIR=/app/bin",
                "INSTALL_INCLUDE_DIR=/app/include",
                "INSTALL_PLUGINS_DIR=/app/lib/ladspa"
              ],
              "no-autogen": true,
              "subdir": "src",
              "sources": [
                {
                  "type": "archive",
                  "url": "http://www.ladspa.org/download/ladspa_sdk_1.13.tgz",
                  "sha256": "b5ed3f4f253a0f6c1b7a1f4b8cf62376ca9f51d999650dd822650c43852d306b"
                },
                {
                  "type": "patch",
                  "path": "ladspa-sdk-fix-memleak.patch",
                  "strip-components": 0
                },
                {
                  "type": "shell",
                  "commands": [ "sed -i 's|mkdirhier|mkdir -p|' src/makefile" ]
                }
              ],
              "cleanup": [ "*" ]
            },
            {
              "name": "swh-plugins",
              "config-opts": [ "--prefix=/app" ],
              "sources": [
                {
                  "type": "git",
                  "url": "https://github.com/swh/ladspa.git",
                  "branch": "v0.4.17",
                  "commit": "8b50f3434b8b30dff16020d17608ced9ee04477b"
                },
                {
                  "type": "patch",
                  "path": "swh-plugins-disable-unused.patch"
                }
              ],
              "post-install": [
                "install -Dm644 COPYING /app/share/licenses/swh-plugins/COPYING"
              ],
              "cleanup": [ "/share/ladspa" ],
              "modules": [{
                "name": "fftw",
                "config-opts": [
                  "--prefix=/app",
                  "--disable-doc",
                  "--enable-float"
                ],
                "build-options": {
                  "arch": {
                    "x86_64": {
                      "cflags": "-fPIC",
                      "cxxflags": "-fPIC"
                    }
                  }
                },
                "sources": [{
                  "type": "archive",
                  "url": "http://www.fftw.org/fftw-3.3.6-pl2.tar.gz",
                  "sha256": "a5de35c5c824a78a058ca54278c706cdf3d4abba1c56b63531c2cb05f5d57da2"
                }],
                "cleanup": [ "*" ]
              }]
            }
          ]
        }
      ]
    }
  ]
}
